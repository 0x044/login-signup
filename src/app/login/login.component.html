<div class="center-container">
  <mat-card class="login-card">
    <mat-card-header>
      <mat-card-title>Welcome back</mat-card-title>
      <mat-card-subtitle>Sign in to your account</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <div *ngIf="errorMessage" class="alert alert-danger" role="alert" style="background-color: #f8d7da; color: #721c24; padding: 10px; border-radius: 4px; margin-bottom: 16px; display: flex; align-items: center;">
        <mat-icon style="margin-right: 8px;">error_outline</mat-icon>
        <span>{{ errorMessage }}</span>
      </div>

      <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Username</mat-label>
          <input matInput
                 id="username"
                 formControlName="username"
                 placeholder="Enter your username"
                 autocomplete="username"
                 required>
          <mat-icon matPrefix>person_outline</mat-icon>
          <mat-error *ngIf="username?.invalid && username?.touched">
            {{ getErrorMessage('username') }}
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Password</mat-label>
          <input matInput
                 [type]="showPassword ? 'text' : 'password'"
                 id="password"
                 formControlName="password"
                 placeholder="Enter your password"
                 autocomplete="current-password"
                 required>
          <mat-icon matPrefix>lock_outline</mat-icon>
          <button mat-icon-button matSuffix type="button" (click)="togglePasswordVisibility()" [attr.aria-label]="showPassword ? 'Hide password' : 'Show password'">
            <mat-icon>{{showPassword ? 'visibility_off' : 'visibility'}}</mat-icon>
          </button>
          <mat-error *ngIf="password?.invalid && password?.touched">
            {{ getErrorMessage('password') }}
          </mat-error>
        </mat-form-field>

        <div class="form-options">
          <a mat-button color="primary" (click)="navigateToForgotPassword()" class="forgot-link">Forgot password?</a>
        </div>

        <button mat-raised-button color="primary" type="submit" class="full-width submit-button" [disabled]="isLoading || loginForm.invalid">
          <span *ngIf="!isLoading">Sign in</span>
          <span *ngIf="isLoading" style="display: flex; align-items: center; justify-content: center;">
            <mat-spinner diameter="20" style="margin-right: 8px;"></mat-spinner>
            Signing in...
          </span>
        </button>
      </form>

      <div class="signup-section">
        <p>Don't have an account?
          <button mat-button color="primary" type="button" (click)="navigateToSignup()">
            Sign up
          </button>
        </p>
      </div>

    </mat-card-content>
  </mat-card>
</div>

<style>
  .login-card {
    max-width: 400px;
    width: 100%;
  }
  .full-width {
    width: 100%;
    margin-bottom: 16px; /* Spacing between fields */
  }
  .form-options {
    display: flex;
    justify-content: flex-end;
    margin-bottom: 16px;
  }
  .forgot-link {
    font-size: 0.9em;
  }
  .submit-button {
      padding: 10px 0;
      margin-top: 8px;
  }
  .divider {
    margin: 24px 0;
    position: relative;
  }
  .signup-section {
    text-align: center;
    margin-top: 24px;
    font-size: 0.9em;
  }
  .signup-section p {
    margin: 0;
    color: rgba(0,0,0,.8);
  }
    .alert {
    display: flex;
    align-items: center;
    padding: 10px;
    margin-bottom: 16px;
    border-radius: 4px;
  }
  .alert-danger {
    background-color: #f8d7da;
    color: #721c24;
  }
  .alert mat-icon {
    margin-right: 8px;
  }
</style>
